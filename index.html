<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard 99 Pop v2</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;background:#000;color:#fff}.header{background:#1a1a1a;padding:15px 20px;border-bottom:3px solid #00ff88;position:fixed;top:0;left:0;right:0;z-index:100;box-shadow:0 4px 12px rgba(0,0,0,.3)}.header-content{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;gap:20px}.logo{font-size:1.3rem;font-weight:700;color:#00ff88}.timer{font-size:2rem;font-weight:700;color:#00ff88;letter-spacing:2px;font-family:"Courier New",monospace;text-shadow:0 0 10px rgba(0,255,136,.5)}.timer-label{font-size:.7rem;color:#666;text-transform:uppercase}.pause-timer{font-size:1.1rem;font-weight:700;color:#ffa500;font-family:"Courier New",monospace;display:none;animation:pulse 1.5s ease-in-out infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.6}}.container{max-width:1200px;margin:0 auto;padding:90px 20px 20px}.card{background:#1a1a1a;border-radius:12px;padding:20px;margin-bottom:20px;border:2px solid #333}.card-title{font-size:1.1rem;color:#00ff88;margin-bottom:15px;font-weight:700}.status{text-align:center;padding:15px;border-radius:8px;font-weight:700;margin-bottom:15px;text-transform:uppercase}.status.inativa{background:#404040;color:#999}.status.ativa{background:#00ff88;color:#000}.status.pausada{background:#ffa500;color:#000}.status-toggle{display:flex;justify-content:space-between;align-items:center;cursor:pointer;user-select:none;padding:5px}.chevron{font-size:1.5rem;color:#00ff88;transition:transform .3s ease;font-weight:700}.chevron.collapsed{transform:rotate(-90deg)}.time-stats{display:none;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:15px;padding:20px;background:#0d0d0d;border-radius:8px;border:2px solid #333;max-height:500px;overflow:hidden;transition:all .3s ease;opacity:1}.time-stats.collapsed{max-height:0;padding:0;opacity:0;margin-bottom:0;border-width:0}.time-stat{text-align:center;padding:15px;background:#1a1a1a;border-radius:8px;border:1px solid #333}.time-stat-label{font-size:.75rem;color:#999;text-transform:uppercase;margin-bottom:10px}.time-stat-value{font-size:2rem;font-weight:700;color:#00ff88;font-family:"Courier New",monospace}.time-stat-value.pause{color:#ffa500}.btn-group{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}.btn{padding:15px;border:none;border-radius:8px;font-size:.95rem;font-weight:700;cursor:pointer;transition:all .2s}.btn:disabled{opacity:.3;cursor:not-allowed}.btn-iniciar{background:#00ff88;color:#000}.btn-pausar{background:#ffa500;color:#000}.btn-encerrar{background:#ff4444;color:#fff}.btn-cancelar{background:#9333ea;color:#fff}.btn:hover:not(:disabled){transform:translateY(-2px)}.progress-container{margin-bottom:20px}.progress-header{display:flex;justify-content:space-between;margin-bottom:10px}.progress-label{font-size:.9rem;color:#999}.progress-value{font-size:1.2rem;font-weight:700;color:#00ff88}.progress-bar-bg{width:100%;height:30px;background:#0d0d0d;border-radius:15px;overflow:hidden;border:2px solid #333;position:relative}.progress-bar-fill{height:100%;background:linear-gradient(90deg,#00ff88,#00cc6f);border-radius:13px;transition:width .5s ease;display:flex;align-items:center;justify-content:flex-end;padding-right:12px}.progress-bar-fill.complete{background:linear-gradient(90deg,#ffa500,#ff8800)}.progress-percentage{color:#000;font-weight:700;font-size:.85rem}.progress-percentage-outside{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:#666;font-weight:700;font-size:.85rem}.kpi-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px}.kpi{background:#1a1a1a;border:2px solid #333;border-radius:12px;padding:20px;transition:all .2s}.kpi.clickable{cursor:pointer}.kpi.clickable:hover{border-color:#00ff88;transform:translateY(-2px)}.kpi-label{font-size:.8rem;color:#999;text-transform:uppercase}.kpi-value{font-size:2rem;font-weight:700;color:#00ff88}.kpi-sub{font-size:.75rem;color:#666}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);z-index:1000}.modal.active{display:flex;align-items:center;justify-content:center}.modal-content{background:#1a1a1a;max-width:500px;width:90%;padding:30px;border-radius:12px;border:2px solid #00ff88}.modal-title{font-size:1.5rem;color:#00ff88;margin-bottom:20px;text-align:center}.form-group{margin-bottom:20px}.form-label{display:block;font-size:.9rem;color:#999;margin-bottom:8px}.form-input{width:100%;padding:12px;background:#0d0d0d;border:2px solid #333;border-radius:8px;color:#fff;font-size:1rem}.form-input:focus{outline:0;border-color:#00ff88}.toast{position:fixed;bottom:30px;right:30px;background:#00ff88;color:#000;padding:15px 25px;border-radius:8px;font-weight:700;z-index:2000;display:none}.toast.show{display:block}
</style>
</head>
<body>
<div class="header">
<div class="header-content">
<div class="logo">Dashboard 99 Pop v2</div>
<div>
<div class="timer" id="timer">00:00:00</div>
<div class="timer-label" id="timerLabel">Aguardando início</div>
<div class="pause-timer" id="pauseTimer">00:00:00</div>
</div>
</div>
</div>

<div class="container">
<div class="card">
<div class="status-toggle" onclick="toggleTimers()">
<div class="status inativa" id="status">Jornada Inativa</div>
<div class="chevron collapsed" id="chevron">▼</div>
</div>
<div class="time-stats collapsed" id="timeStats">
<div class="time-stat">
<div class="time-stat-label">Tempo Operando</div>
<div class="time-stat-value" id="tempoOperando">00:00:00</div>
</div>
<div class="time-stat">
<div class="time-stat-label">Tempo em Pausa</div>
<div class="time-stat-value pause" id="tempoPausado">00:00:00</div>
</div>
<div class="time-stat">
<div class="time-stat-label">Tempo Total</div>
<div class="time-stat-value" id="tempoTotal">00:00:00</div>
</div>
</div>
<div class="btn-group">
<button class="btn btn-iniciar" id="btnIniciar" onclick="iniciar()">Iniciar</button>
<button class="btn btn-pausar" id="btnPausar" onclick="pausar()" disabled>Pausar</button>
<button class="btn btn-pausar" id="btnRetomar" onclick="retomar()" disabled style="display:none">Retomar</button>
<button class="btn btn-cancelar" id="btnCancelar" onclick="cancelar()" disabled>Cancelar</button>
<button class="btn btn-encerrar" id="btnEncerrar" onclick="encerrar()" disabled>Encerrar</button>
</div>
</div>

<div class="card">
<div class="card-title">Progresso da Meta</div>
<div class="progress-container">
<div class="progress-header">
<div><span class="progress-label">Faturamento</span> <span class="progress-value" id="fatProgresso">R$ 0,00</span></div>
<div><span class="progress-label">Meta</span> <span class="progress-value" id="metaProgresso">R$ 400,00</span></div>
</div>
<div class="progress-bar-bg">
<div class="progress-bar-fill" id="progressBar" style="width:0%">
<span class="progress-percentage" id="progressPct">0%</span>
</div>
<span class="progress-percentage-outside" id="progressPctOutside">0%</span>
</div>
</div>
</div>

<div class="card">
<div class="card-title">Performance (clique para editar)</div>
<div class="kpi-grid">
<div class="kpi clickable" onclick="editarFat()">
<div class="kpi-label">Faturamento</div>
<div class="kpi-value" id="fat">R$ 0,00</div>
</div>
<div class="kpi clickable" onclick="editarCorridas()">
<div class="kpi-label">Corridas</div>
<div class="kpi-value" id="corridas">0</div>
</div>
</div>
</div>
</div>

<div class="modal" id="modalAbast">
<div class="modal-content">
<div class="modal-title">Adicionar Abastecimento</div>
<div class="form-group">
<label class="form-label">Litros</label>
<input type="number" step="0.01" class="form-input" id="inputLitros" placeholder="Ex: 45.5" onInput="calcAbast('litros')">
</div>
<div class="form-group">
<label class="form-label">Preço por Litro (R$)</label>
<input type="number" step="0.01" class="form-input" id="inputPreco" placeholder="Ex: 5.89" onInput="calcAbast('preco')">
</div>
<div class="form-group">
<label class="form-label">Valor Total (R$)</label>
<input type="number" step="0.01" class="form-input" id="inputValor" placeholder="Ex: 268.00" onInput="calcAbast('valor')">
</div>
<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:20px">
<button class="btn btn-cancelar" onclick="fecharModal()">Cancelar</button>
<button class="btn btn-iniciar" onclick="salvarAbast()">Salvar</button>
</div>
</div>
</div>

<div class="toast" id="toast"></div>

<script>
let d={ativa:false,pausada:false,inicio:null,tempoPausaTotal:0,inicioPausaAtual:null,metaFat:400,fat:0,corr:0,timersExpanded:false};
function load(){const s=localStorage.getItem("d99v2");if(s){d={...d,...JSON.parse(s)};d.inicio=d.inicio?new Date(d.inicio):null;d.inicioPausaAtual=d.inicioPausaAtual?new Date(d.inicioPausaAtual):null}}
function save(){const s={...d};s.inicio=s.inicio?s.inicio.toISOString():null;s.inicioPausaAtual=s.inicioPausaAtual?s.inicioPausaAtual.toISOString():null;localStorage.setItem("d99v2",JSON.stringify(s))}
function fmt(ms){const t=Math.max(0,Math.floor(ms/1000));const h=String(Math.floor(t/3600)).padStart(2,"0");const m=String(Math.floor((t%3600)/60)).padStart(2,"0");const s=String(t%60).padStart(2,"0");return h+":"+m+":"+s}
function fmtMoney(v){return"R$ "+Number(v||0).toFixed(2).replace(".",",")}
function render(){const agora=new Date();let decorrido=0,pausaAtual=0,pausaTotal=0,operando=0;if(d.ativa&&d.inicio){decorrido=agora-d.inicio;if(d.pausada&&d.inicioPausaAtual)pausaAtual=agora-d.inicioPausaAtual;pausaTotal=d.tempoPausaTotal+pausaAtual;operando=decorrido-pausaTotal}
const statusEl=document.getElementById("status");if(!d.ativa){statusEl.className="status inativa";statusEl.textContent="Jornada Inativa"}else if(d.pausada){statusEl.className="status pausada";statusEl.textContent="Pausado"}else{statusEl.className="status ativa";statusEl.textContent="Em Operação"}
document.getElementById("btnIniciar").disabled=d.ativa;document.getElementById("btn
